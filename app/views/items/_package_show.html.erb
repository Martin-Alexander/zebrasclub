<% in_session_cart = false %>
<% order_item_list = OrderItem.where(item_id: @item.id).where(package: true) %>
<% order_item = order_item_list.select do |i| %>
  <% i.user == current_user %>
<% end %>
<% session[:package_items].each do |i| %>
  <% if i["id"] == @item.id && i["cart"] == true %>
    <% in_session_cart = true %>
  <% end %>
<% end %>

<div class="package-item-container">
  <div class="package-item-photo">
    <div class="main-photo" style="background-image: url(<%= @item.picture %>);">
    </div>
    <div class="bottom-photo-container">
      <div class="bottom-photo", style="background-image: url(../../assets/bauer-hockey-helmet-9900-inset3.jpg);"></div>
      <div class="bottom-photo", style="background-image: url(../../assets/bauer-hockey-helmet-9900-inset3.jpg);"></div>
      <div class="bottom-photo", style="background-image: url(../../assets/bauer-hockey-helmet-9900-inset3.jpg);"></div>
    </div>
  </div>
  <div class="package-item-details-container">
    <div class="package-item-details">
      <div class="package-item-main-header">
        <h1><%= Category.find(@item.category_id).item_type.upcase %></12>
        <h3>$<%= @item.price / 100 %>.00</h3>
      </div>
      <div class="package-item-sub-header">
        <h3><%= @item.brand %></h3>
      </div>
      <div class="package-item-sizes">
        <a href="#"><div class="size-circle"><h3>xs</h3></div></a>
        <a href="#"><div class="size-circle"><h3>sm</h3></div></a>
        <a href="#"><div class="size-circle"><h3>md</h3></div></a>
        <a href="#"><div class="size-circle"><h3>lg</h3></div></a>
        <a href="#"><div class="size-circle"><h3>xl</h3></div></a>
      </div>
      <div class="package-item-description">
        <p><%= @item.description %></p>
      </div>
    </div>
    <div class="package-item-buttons">
      <% if !((current_user && order_item[0].cart) || (!current_user && in_session_cart)) %>
        <div class="other-items-button">
          <%= link_to "Other #{Category.find(@item.category_id).item_type.pluralize}", package_items_path(category: Category.find(@item.category_id).item_type, item: @item.id), remote: true, method: :post, class: "btn base-button other-items" %>
        </div>
        <div class="add-to-cart-button">
          <% if current_user %>
            <%= link_to "Add to cart", edit_orderitem_path(@item.id, {user: current_user.id}), remote: true, method: :patch, class: "btn cart-button add-to-cart" %>
          <% else %>
            <%= link_to "Add to cart", edit_orderitem_path(@item.id), remote: true, method: :patch, class: "btn cart-button add-to-cart" %>
          <% end %>
        </div>
      <% else %>
        <%= link_to "Main", package_main_path, remote: true, class: "btn base-button back-to-main" %>
      <% end %>
    </div>
  </div>
</div>



